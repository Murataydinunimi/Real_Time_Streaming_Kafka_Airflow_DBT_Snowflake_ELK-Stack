[0m15:18:59.150221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee612b26d8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee612b2f98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee612b2a90>]}


============================== 15:18:59.298013 | 63252c49-9f8b-4afb-911d-26c8ebf4e828 ==============================
[0m15:18:59.298013 [info ] [MainThread]: Running with dbt=1.5.0
[0m15:18:59.301119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/dbtlearn/logs', 'profiles_dir': '/dbtlearn', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:19:00.573555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63252c49-9f8b-4afb-911d-26c8ebf4e828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee612b2630>]}
[0m15:19:00.739621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63252c49-9f8b-4afb-911d-26c8ebf4e828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5bc882b0>]}
[0m15:19:00.941834 [debug] [MainThread]: checksum: 4568eb639a77b8fcb3a1f4a07856f42b1ff63f1376652889143968e1dbdafbda, vars: {}, profile: , target: , version: 1.5.0
[0m15:19:02.597876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:02.599655 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:02.622248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63252c49-9f8b-4afb-911d-26c8ebf4e828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5bc29780>]}
[0m15:19:02.792136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63252c49-9f8b-4afb-911d-26c8ebf4e828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5bcc53c8>]}
[0m15:19:02.803164 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 1 seed file, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:19:02.806395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63252c49-9f8b-4afb-911d-26c8ebf4e828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5bcc5208>]}
[0m15:19:02.815927 [info ] [MainThread]: 
[0m15:19:02.835279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:19:02.841172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:19:02.896189 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:19:02.898768 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:19:02.901212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:04.893162 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m15:19:04.907309 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:19:05.018866 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m15:19:05.052112 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m15:19:05.055900 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "dbtlearn", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV
[0m15:19:05.061572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:05.500580 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m15:19:05.524400 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m15:19:05.676009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63252c49-9f8b-4afb-911d-26c8ebf4e828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5ab28240>]}
[0m15:19:05.697247 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:05.698848 [info ] [MainThread]: 
[0m15:19:05.726013 [debug] [Thread-1  ]: Began running node model.dbtlearn.review_score_total_stay
[0m15:19:05.730831 [info ] [Thread-1  ]: 1 of 1 START sql table model DEV.review_score_total_stay ....................... [RUN]
[0m15:19:05.733246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearn.review_score_total_stay)
[0m15:19:05.750640 [debug] [Thread-1  ]: Began compiling node model.dbtlearn.review_score_total_stay
[0m15:19:05.769894 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbtlearn.review_score_total_stay"
[0m15:19:05.814283 [debug] [Thread-1  ]: Timing info for model.dbtlearn.review_score_total_stay (compile): 15:19:05.753395 => 15:19:05.813639
[0m15:19:05.815997 [debug] [Thread-1  ]: Began executing node model.dbtlearn.review_score_total_stay
[0m15:19:05.958243 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbtlearn.review_score_total_stay"
[0m15:19:05.999403 [debug] [Thread-1  ]: Using snowflake connection "model.dbtlearn.review_score_total_stay"
[0m15:19:06.001523 [debug] [Thread-1  ]: On model.dbtlearn.review_score_total_stay: /* {"app": "dbt", "dbt_version": "1.5.0", "profile_name": "dbtlearn", "target_name": "dev", "node_id": "model.dbtlearn.review_score_total_stay"} */
create or replace transient table AIRBNB.DEV.review_score_total_stay
         as
        (


with province_extracted as (select *, 
split(listing_title,'Â·')[0] as province_str,
REGEXP_SUBSTR(province_str, 'IN\\s+(.+)', 1, 1, 'i') AS province_regexp,
upper(REPLACE(split(province_regexp,' ')[1],'""','')) as province
from airbnb.dev.bl_listings_cleansed
where province != 'ISTANBUL' and province!='Ä°STANBUL' and province!=''),

review_score_cleaned as (select listing_id,split(listing_title,'Â·')[1] as review_score_raw,
REPLACE(review_score_raw,'""','') as review_score_no_quotes,
REPLACE(review_score_no_quotes,'â˜…','')as review_score_no_star,
  CASE
    WHEN TRY_CAST(review_score_no_star AS float) IS NOT NULL THEN TRY_CAST(review_score_no_star AS float)
    ELSE NULL
  END AS review_score
from airbnb.dev.bl_listings_cleansed
where review_score is not null),

 ctes_joined as (select pe.listing_id, pe.listing_title, pe.room_type, pe.MINIMUM_NIGHTS, pe.price, pe.province,rsc.review_score
 from province_extracted pe
 join review_score_cleaned rsc on rsc.listing_id = pe.listing_id)

select province, avg(review_score) as average_review_score, count(*) as total_stay
from ctes_joined
group by province
having total_stay > 10
order by average_review_score desc
        );
[0m15:19:06.003029 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:19:07.212178 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m15:19:07.316630 [debug] [Thread-1  ]: Timing info for model.dbtlearn.review_score_total_stay (execute): 15:19:05.817674 => 15:19:07.316052
[0m15:19:07.319985 [debug] [Thread-1  ]: On model.dbtlearn.review_score_total_stay: Close
[0m15:19:07.415806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63252c49-9f8b-4afb-911d-26c8ebf4e828', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee595b2ba8>]}
[0m15:19:07.419269 [info ] [Thread-1  ]: 1 of 1 OK created sql table model DEV.review_score_total_stay .................. [[32mSUCCESS 1[0m in 1.68s]
[0m15:19:07.427367 [debug] [Thread-1  ]: Finished running node model.dbtlearn.review_score_total_stay
[0m15:19:07.473688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:07.477683 [debug] [MainThread]: Connection 'list_AIRBNB' was properly closed.
[0m15:19:07.480303 [debug] [MainThread]: Connection 'model.dbtlearn.review_score_total_stay' was properly closed.
[0m15:19:07.490823 [info ] [MainThread]: 
[0m15:19:07.498560 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m15:19:07.515500 [debug] [MainThread]: Command end result
[0m15:19:07.637797 [info ] [MainThread]: 
[0m15:19:07.639958 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:07.643015 [info ] [MainThread]: 
[0m15:19:07.646390 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:19:07.650514 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:07.649810 after 8.73 seconds
[0m15:19:07.652809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee612b2eb8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee64861908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee58560f28>]}
[0m15:19:07.655824 [debug] [MainThread]: Flushing usage events
